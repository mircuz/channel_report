\documentclass[a4paper,twosides,openright,titlepage]{book}
\usepackage[italian,english]{babel}
\usepackage[ autostyle,italian=guillemets]{csquotes}
\usepackage[bibstyle=numeric,backend=biber]{biblatex}
\addbibresource{bibliography.bib}

\usepackage{frontespizio}
\usepackage{etoolbox}
\usepackage[Bjornstrup]{fncychap}


\preto\chapter{\raggedright}
\usepackage{microtype,amsmath,booktabs,graphicx,fancyhdr,listings,xcolor,multirow,wrapfig,hyperref}
\usepackage[section]{placeins}

\newenvironment{abstract}% 
	{\cleardoublepage%
		\thispagestyle{empty}% 
		\null \vfill\begin{center}%
		\bfseries \abstractname \end{center}}% 
	{\vfill\null}

\definecolor{mygray}{rgb}{0.28,0.28,0.28}
\lstset{%frame=tb,
  xleftmargin=\parindent,
  language=C,
  backgroundcolor = \color{lightgray},
  commentstyle=\color{mygray},
  aboveskip=3mm,
  belowskip=3mm,
  showstringspaces=false,
  columns=flexible,
  basicstyle={\small\ttfamily},
  numbers=none,
  breaklines=true,
  breakatwhitespace=true,
  tabsize=4
  %xleftmargin = 2cm
}
\setcounter{tocdepth}{4}
\setcounter{secnumdepth}{4}

\begin{document}

\begin{frontespizio}
\makeatletter
\begin{Preambolo*}
\usepackage{etoolbox}
\makeatletter
\patchcmd{\preparefrontpagestandard}
  {\if\@front@{logo} 
   \includegraphics[height=\front@logosize]{\front@logo}\par
   \vspace{\frontlogosep}
   \fi}
  {}
  {}{}
\patchcmd{\preparefrontpagestandard}
  {\if\@front@{school}
   \front@school
   \else
   Corso di \front@cl
   \fi}
  {Corso di \front@cl
  \par\if\@front@{logo}
   \vspace{4\frontlogosep}
   \includegraphics[height=\front@logosize]{\front@logo}\par
   \vspace{\frontlogosep}
   \fi
  }{}{}
\makeatother
\end{Preambolo*}
\makeatother
\Istituzione {POLITECNICO DI MILANO}
\Logo[6.5cm]{grafici/logo_Polimi} 
\Divisione{Scuola di Ingegneria Industriale}
\Corso [Laurea Magistrale]{Ingegneria Aeronautica }
\Titolo {Scaling Performance of a DNS \\
 solver written in CPL}
\Candidato{{Mirco Meazzo\\  873477}}
\Relatore {Prof. Maurizio Quadrio}
%\NCorrelatore {Relatore esterno}{Relatori esterni}
\Correlatore{ ...}
\Annoaccademico {2018-2019}
\end{frontespizio} 

\frontmatter
\selectlanguage{english}
\graphicspath{grafici}

\begin{flushright} 
\null\vspace{\stretch{1}}
\pagestyle{empty}
\par Dedicata alla mia famiglia,\par a chi mi ha sempre sostenuto, \par a chi è presente oggi \par e a chi non c'è più
\vspace{\stretch{2}}\null
\end{flushright}




\begin{abstract}
\hrulefill

A numerical method for the direct numerical simulation of the incompressible Navier–Stokes equations in rectangular geometries is presented. The method implement the MPI Standard~\cite{MPI} to the engine developed by M.~Quadrio and P.~Luchini described in~\cite{cpl:presentazione}. 

The method is based on Fourier expansions in the homogeneous directions and fourth-order accurate, compact finite-difference schemes over a variable-spacing mesh in the wall-normal direction. 

Two different versions of the solver have been developed, based on the domain decomposition.  In the first the domain is decomposed through 1D (\emph{Slab}), while in the second version 2D (\emph{Pencil}) decomposition is used.
The performances of these versions have been compared against each other.

To manage the decomposition we rely on the APIs present in \emph{fftMPI}, developed by Steve Plimpton at Sandia National Laboratories~\cite{fftMPI}.
\\
\\
\\
\emph{Key words}: Navier–Stokes equations, direct numerical simulation, parallel computing, turbulence, 2D decomposition, pencil 

\hrulefill
\end{abstract}




\tableofcontents 
\listoffigures 
\listoftables



\mainmatter
\input{capitoli/introduction}
\input{capitoli/code_struct}
%\input{capitoli/io}

\chapter{Code Benchmarks}
\input{capitoli/chap_128}
\input{capitoli/chap_256}
\input{capitoli/chap_512}
\input{capitoli/chap_2048}

\backmatter
\addcontentsline{toc}{chapter}{\bibname} 
\printbibliography

\end{document}
